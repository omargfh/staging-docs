import{d as k,u as v,I as C,c as S,w as p,k as u,M as D,o as b,f,D as N,i as y,h as d,t as R,j as L}from"#entry";import V from"./N0XfabAP.js";import A from"./DEBTlJyi.js";import"./XTsjbtln.js";import"./DD8IzUh9.js";import"./CWlZgi5v.js";import"./FfqProDb.js";import"./DhYsbkfx.js";import"./DM4ggvH4.js";import"./DyRp4474.js";import"./Cys3SCtC.js";import"./CrshMrC1.js";import"./De8Fi2FY.js";import"./dkMh8LOU.js";import"./CH_3uCfS.js";function h(e){return e.replace(/\.html$/,"")}class F{key;lifetimeMs;constructor(t,o=null){this.key=t,this.lifetimeMs=o}get(){const t=JSON.parse(localStorage.getItem(this.key)||"null");return t&&this.checkValidity(t)?t.data:null}set(t){const o={data:t,timestamp:Date.now()};localStorage.setItem(this.key,JSON.stringify(o))}delete(){localStorage.removeItem(this.key)}checkValidity(t){return this.lifetimeMs===null?!0:!(Date.now()-t.timestamp>this.lifetimeMs)}}function M(e,t=null,o){return async()=>{const s=new F(e,t),l=s.get();if(l!==null)return l;const c=await o();return setTimeout(()=>s.set(c),0),c}}const U={class:"w-full [&>.min-h-screen]:min-h-0 lg:pr-5 pb-10 min-h-rest"},j={class:"p-4 md:p-0"},P=k({__name:"PrimitiveCatalog",props:{surround:{},dictionaryDisplayName:{},dictionaryHomeDirectory:{},indexFileURI:{},currentItemId:{},currentItemLabel:{},primRoot:{}},async setup(e){let t,o;const s=v(),l=a=>a.id===e.currentItemId,c=a=>{const n=a.toLowerCase();return(m.value||[]).filter(r=>r.title.toLowerCase().includes(n))},g=async a=>(await $fetch(a)).split(`
`).map(i=>i.trim()).map(i=>i.split(" ")).filter(i=>i.length===2).filter(i=>i.every(r=>typeof r=="string")).map(i=>({name:i[0],htmlId:h(i[1])})).map(({name:i,htmlId:r})=>({id:r,title:i??"",url:"/"+[e.primRoot,encodeURIComponent(r)].join("/")})),{data:m,pending:I,error:x}=([t,o]=C(()=>D(e.indexFileURI,M([s.productVersion,"primitive-catalog",e.indexFileURI].join("-"),null,()=>g(e.indexFileURI)),{server:!1})),t=await t,o(),t),w=!Array.isArray(m.value)&&!x?!0:I;return(a,n)=>{const i=L,r=V,_=A;return b(),S(_,{label:e.dictionaryDisplayName,items:u(m)||[],"item-prefix":"primitive:",query:c,"is-selected":l,"selected-item-label":e.currentItemLabel,"scroll-margin-top":150,"is-loading":u(w),"with-route-transition":""},{default:p(()=>[f("div",U,[N(a.$slots,"default"),f("p",j,[n[0]||(n[0]=d(" Take me to the full ",-1)),y(i,{href:u(h)(e.dictionaryHomeDirectory)},{default:p(()=>[d(R(e.dictionaryDisplayName),1)]),_:1},8,["href"]),n[1]||(n[1]=d(". ",-1))]),y(r,{surround:e.surround,class:"mt-auto"},null,8,["surround"])])]),_:3},8,["label","items","selected-item-label","is-loading"])}}}),Z=Object.assign(P,{__name:"PrimitiveCatalog"});export{Z as default};
